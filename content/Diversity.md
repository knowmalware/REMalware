# Diversity

The malware landscape is more diverse than ever.  Rootkits, RATs, and keyloggers are still around, but so are Ransomware and so-called "fileless" malware.  How malware is written has also diversified.  While not as common as they used to be Visual Basic and Delphi are still around.  But today's malware analyst must be ready to learn how to analyze and deobfuscate the result of a new language or compiler, often at a moment's notice.


## File types (by functionality)
- network/port/service mapper or scanner

- Exploit
- Downloader
- Dropper
- Trojan
- Virus
- Worm

- Bootkit
- Rootkit
- RAT
    - implant
    - controller
    - builder
- Webshell

- Spyware
- [Smartcard sniffer](https://www.alienvault.com/blogs/labs-research/sykipot-variant-hijacks-dod-and-windows-smart-cards)
- Ransomware
- Scareware
- Adware / PUPs

- Botnet

- Wiper

- [Lateral movement](https://attack.mitre.org/wiki/Lateral_Movement)

- [Collection](https://attack.mitre.org/wiki/Collection)
    - keylogger
    - screen grabber
    - video grabber
    - credential stealer
        - RAM scraper

- [Exfiltration](https://attack.mitre.org/wiki/Exfiltration)



## File types (by language, compiler, or operating system)

### .NET (dotnet / Mono / MSIL)

Example(s):

- https://www.red-gate.com/simple-talk/blogs/anatomy-of-a-net-assembly-clr-metadata-1/

Tool(s):

- ildasm
- [dnSpyEx](https://github.com/dnSpyEx/dnSpy)
- [de4dot](https://github.com/de4dot/de4dot)
    - [de4dot CEx](https://github.com/ViRb3/de4dot-cex)


### Powershell

Example(s):

- https://blog.cyber4sight.com/2017/02/malicious-powershell-script-analysis-indicates-shamoon-actors-used-pupy-rat/
- https://blog.talosintelligence.com/2017/03/dnsmessenger.html
- [FireEye Blog - PowerShell Backdoor POSHSPY](https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html)

Tool(s):

- [PowershellISE](https://docs.microsoft.com/en-us/powershell/scripting/core-powershell/ise/introducing-the-windows-powershell-ise)
- [VS Code](https://docs.microsoft.com/en-us/powershell/scripting/core-powershell/vscode/using-vscode)


### VBScript

Example(s):

- https://www.volexity.com/blog/2016/11/09/powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos/

Tool(s):

- Notepad + cscript
- Visual Studio + *cscript /x*
- other commercial IDEs with debugging support


### Python

Example(s):

- https://www.anomali.com/blog/crushing-python-malware
- [FireEye Blog - Irongate ICS Malware](https://www.fireeye.com/blog/threat-research/2016/06/irongate_ics_malware.html)

Tool(s):

- [unpy2exe](https://github.com/matiasb/unpy2exe)
- [pyinstxtractor](https://sourceforge.net/projects/pyinstallerextractor/)
- [uncompyle6](https://pypi.org/project/uncompyle6/)


### PHP and ASP

A *webshell* is a bit of code inserted on a web server into an existing web page, or added as a new page, that will provide an intruder the ability to run commands on the server simply by visiting the page with a web browser.  *PHP* and *ASP* are common dynamic content types, and so are common webshell types as well.

Example(s):

- https://www.us-cert.gov/ncas/alerts/TA15-314A
- https://www.tenable.com/blog/hunting-for-web-shells
- https://github.com/tennc/webshell


### ELF

ARM and MIPS are common architectures in the IoT world and are very different from Intel.  Some instructions will be familiar, but common assembly phrasing from compilers will be different.

Example(s):

- https://github.com/jgamblin/Mirai-Source-Code
- https://krebsonsecurity.com/2017/10/reaper-calm-before-the-iot-security-storm/
- https://researchcenter.paloaltonetworks.com/2018/01/unit42-iot-malware-evolves-harvest-bots-exploiting-zero-day-home-router-vulnerability/


### MachO

*MachO* is the executable file format for macOS.

Example(s):

- https://objective-see.com/malware.html


### BIOS, UEFI

These are sometimes called *bootkits*.

Example(s):

- http://blog.virustotal.com/2016/01/putting-spotlight-on-firmware-malware_27.html
- https://www.welivesecurity.com/2017/10/19/malware-firmware-exploit-sense-security/


### Java

Java malware can come in the form of java bytecode (CLASS file) or a java archive (JAR file).

Example(s):

- https://malpedia.caad.fkie.fraunhofer.de/details/jar.jrat
- https://westoahu.hawaii.edu/cyber/vulnerability-research/vulnerabilities-weekly-summaries/crossrat-a-new-cross-platform-malware/
- https://securityaffairs.co/wordpress/89125/malware/java-atm-malware.html

Tool(s):

- https://github.com/Konloch/bytecode-viewer
- https://java-decompiler.github.io/


### Android (dex)

Android malware has been around for several years, but is still relevant today.

Android's DEX format is based on Java.  However, DEX files must be converted before standard Java tools can be used to analyze them.

Tool(s):

- dex2jar
- Java decompilers


### golang

Example(s):

- [Reversing Go Binaries Like a Pro](https://rednaga.io/2016/09/21/reversing_go_binaries_like_a_pro/)
- https://blog.talosintelligence.com/2017/02/athena-go.html
- https://unit42.paloaltonetworks.com/the-gopher-in-the-room-analysis-of-golang-malware-in-the-wild/
- https://www.deepinstinct.com/blog/arid-gopher-the-newest-micropsia-malware-variant

Tool(s):

- https://github.com/mandiant/GoReSym
- https://github.com/goretk/redress
- https://github.com/sibears/IDAGolangHelper
- https://github.com/SentineLabs/AlphaGolang


### Multivariate

Malware composed of multiple pieces written in different languages.  For example, an Office document that contains a VBScript macro, that initializes Powershell, that imports dotnet modules.

Example(s):

- [JavaScript and .NET implant](https://blog.yoroi.company/research/unveiling-jsoutprox-a-new-enterprise-grade-implant/)
- [Powershell + C# + shellcode](https://isc.sans.edu/forums/diary/Malicious+PowerShell+Compiling+C+Code+on+the+Fly/24072/)
- [VBA + Powershell + C#](https://www.ringzerolabs.com/2020/10/obfuscated-vba-powershell-c.html)
