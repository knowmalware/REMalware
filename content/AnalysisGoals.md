# Analysis Goals

## Identification / Detection

There's no silver bullet to in malware detection. Malware authors spend a great deal of time in avoidance of pattern recognition. Despite the ease of defeating byte signatures, don't discount laziness and the fact that malware is going to have to perform certain behavior to be useful. Reuse of analysis results can save a great deal of time. The following can be used to identify 'known' malware:
- File Hashes (Full or Portion)
- Byte Signatures
- System Behavior
- Network Signatures

### Hashes
Hashing algorithms receive a byte sequence (e.g. file content) and calculate a small (<100 byte), repeatable value that represents the sequence. Hashes provide a quick portable method for comparing a file with previously analyzed files. Other than full files, we may hash discrete file portions such as:
- PE Headers/Sections/Resources
- x86 Functions/Code Blocks
- PDF Streams
- Office Document Streams

### Byte Signatures
Historically Anti-Virus engines and Intrusion Detection Systems (IDS) have detected malware and unwanted network traffic using byte signatures. Such signatures may cover code sequences, data constants, or both. They may allow flexibility using wildcards.

#### Strengths
- Cheap

#### Weaknesses
- Susceptible to minor changes such as code-reordering and twiddled bits
- At times results in false positives.

### System Behavior
By monitoring the interactions between applications and the Operating System/Hardware, malicious software can be recognized. This can be done by:
- Comparing current system states with a baseline
- Monitoring API and System calls

### Events
- I/O
    - Disk writes/reads
    - Network send/receive
- Process Management
    - Creation
    - Inter-Process Communcation (IPC)
    - Remote Procedure calls (RPC)
    - Thread Injection
- Configuration
    - Registry Modification

Using behavioral analysis for on a per event process would be very susceptible to false positives as malicious code often behaves similarly to legitimate code.

### Network Signatures
As mentioned, byte signatures are used by IDS to detect malicious network traffic. This can be combined with trend analysis and pattern recognition of the types of connections made and the ports they are communicated over.


## Aiding Incident Response
- Network Analysis:
    - Command and Control Protocol
    - Encryption Keys
- Removing contamination
    - Disk modifications (including files, boot sector)
    - Registry
    - Firmware


## Correlating Attacks
- Shared Functions
- Common strings
    - Domain Names
    - IP Addresses
    - Prompts
    - Network Protocol
- PE Headers
    - Imports
    - Exports
    - Section Names
- Compiler Detected
