# Ransomware

## Introduction

*Ransomware* is malware that prevents you from accessing something, typically files on disk, without paying a ransom.  The concept was first talked about by Adam Young and Moti Yung in their book, *Malicious Cryptography: Exposing Cryptovirology* in 2004.  Ransomware has been around in some form for a while.  Its recent rise in popularity may be partially attributed to the rise in popularity of anonymous online transactions, aka cryptocurrencies like Bitcoin and Ethereum.

To a reverse engineer, knowing that you are looking at ransomware helps to narrow down what you would expect to find.  Most ransomware will include the following functionality:

- persist
- check state
- C2 (optional, but common)
- delete common backup locations
- iterate files on disk(s)
    - filter based on extension
        - we don't want to brick the system; how would we get paid?!
- crypto API calls OR statically-linked OR custom implementation OR custom algo
    - look for API calls (Imports, LoadLibrary)
    - Yara rules and FindCrypt IDA Plugin for crypto constants
    - look for encode/decode loops
- show a message to the user


## Examples

- https://www.secureworks.com/research/cryptolocker-ransomware
- https://www.fireeye.com/blog/threat-research/2016/07/cerber-ransomware-attack.html
- https://www.secureworks.com/research/wcry-ransomware-analysis


## Analysis Tools

- Yara rules for detecting crypto constants
    - https://github.com/Yara-Rules/rules/tree/master/Crypto
- FindCrypt plugins for IDA
    - http://www.hexblog.com/?p=28
    - https://github.com/vlad902/findcrypt2-with-mmx


## Exercises

- [theZoo: Reveton](https://github.com/ytisf/theZoo/tree/master/malwares/Binaries/Win32.Reveton.Y)
- [theZoo: CryptoLocker](https://github.com/ytisf/theZoo/tree/master/malwares/Binaries)
- [follow and duplicate analysis](https://www.secureworks.com/research/cryptolocker-ransomware)
